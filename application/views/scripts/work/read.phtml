<div id="LRcontainer">
<div class="left-menu">
<?php if(!empty($this->work['Interpretations'])): ?>

    <?php foreach($this->work['Interpretations'] as $translation): ?>
    <?php if(isset($translation['work'])): ?>
    
    <?php if($flag == 0): ?><div class="left-section"><?php echo __('Translations'); ?></div><?php endif; ?>
    <?php $flag = 1; ?>
        <span class="translation"><a href="<?php echo $this->url(array('controller'=>'translation','action'=>'read','id'=>$translation['work']['id'])); ?>">
        <?php $title = $this->escape($translation['work']['title']); 
            if($title==''){echo '<i>'.__('No Title').'</i>';} else{echo __($title);} ?>
        </a>(<?php echo __($this->escape($translation['work']['language'])); ?>)</span>
        <br><br>
    <?php endif; ?>
    <?php endforeach; ?>
    
<?php endif; ?>

<?php if($this->isMember){$explainNA=__("You're not allowed to do this. Ask permissions to the text's owner");}
      else{$explainNA=__("You're not allowed to do this. Please login");}
$a_nohref = 'class="idle" title="'.$explainNA.'"';
$HTmessage = __("You can't delete this text because it has some translations. Delete its translations first.");?>


<div class="left-section">
    <?php echo __('Options'); ?></div>

    <?php if($this->showCreate){$href= 'href="'.$this->url(array('controller'=>'work','action'=>'translate','id'=>$this->work['id'])).'"';}
    else {$href = $a_nohref;}?>
    <div class="options"><a <?php echo $href; ?>><?php echo __('Create a translation'); ?></a></div><br>
    
    <?php if($this->showEdit){
        $href_extend= 'href="'.$this->url(array('controller'=>'work','action'=>'extend','id'=>$this->work['id'])).'"';
        $href_edit = 'href="'.$this->url(array('controller'=>'work','action'=>'edit','id'=>$this->work['id'])).'"';}
    else {$href_extend = $href_edit = $a_nohref;}?>
    <div class="options"><a <?php echo $href_extend; ?>><?php echo __('Continue text insertion'); ?></a></div><br>      
    <div class="options"><a <?php echo $href_edit; ?>><?php echo __('Edit the text'); ?></a></div><br>      

    <?php if($this->canManage): ?>
      <div class="options"><a href="<?php echo $this->url(array('controller'=>'work','action'=>'manage','id'=>$this->work['id'])) ?>"><?php echo __("Manage text's privileges"); ?></a></div><br>
    <?php endif; ?>
    
    <?php if($this->canDelete): 
        if($this->hasTranslations==false): 
            $askConfirm = __("WARNING! Deletion is a definitive choice! Are you SURE you want to delete this text?");
            $href= 'href="'.$this->url(array('controller'=>'work','action'=>'delete','id'=>$this->work['id'])).'" onClick="'."return confirm('".$askConfirm."')".'"' ;
        else: $href = 'class="idle" title="'.$HTmessage.'"'; endif;?>
        <div class = "options"><a <?php echo $href; ?> ><?php echo __("Delete this text"); ?></a></div>
    <?endif; ?>

<br><br>

<?php if($this->canTag){echo $this->tagForm; } ?>
</div>


<!--<td id = "right-column">-->
<div class="right-container">
 <div class="show-tag-area">
        <?php if(!empty($this->work['Tags'])): ?>
        <?php foreach($this->work['Tags'] as $genre=>$names): ?>
        <div class="tag-group">
        <span class="genre"><?php echo __($this->work['Genres'][$genre]); ?></span>
        <?php foreach($names as $name=>$tag): ?>
        <span class="tag-item" title="<?php echo __(strtolower($tag[0]['genre_name'])); ?>"> <!--style="font-size:<?php //echo 8+round($tag['multiplicity']*7) ?>px"--> <?php echo $name; ?>
        <?php $canRemove = false;?>
        <?php foreach($tag as $key=>$elem) {if(is_array($elem)&&(!is_null($this->userid))&&(in_array($this->userid,$elem))){ $canRemove = true;} } ?>
        <?php if($canRemove): ?>
            <a class="delete" href="<?php echo $this->url(array('controller'=>'tag','action'=>'deletetag','id'=>$this->work['id'],'tag'=>$name,'genre'=>$genre))?>"> X </a>
        <?php endif; ?>
        </span>
        <?php endforeach; ?>
        </div>
        <?php endforeach; ?>
        <?php endif; ?>
    </div>

<div id = "page-container">
<div class = "Tborder"><div class = "TLcorner"></div><div class = "TRcorner"></div></div>
<!--<div id = "Lborder"><img class = "turn-page" src="<?php //echo $this->makeUrl('/images/previous.png'); ?>"></div>-->
        <div class="Lborder hundred"><div class="Rborder hundred">
            <div class = "work-container hundred">
                <div class = "title" id="work-title"> <?php echo $this->work['title']; ?> </div>
                <div class="language"><?php $author=$this->work['author']; if($author==''){$author=__('Anonymous');}?>
                <?php echo $author.' - '.__($this->work['language']); ?></div>
                <div class = "text"> 
                    <?php foreach ($this->work['Sentences'] as $segnum=>$sentence) : ?>
                        <?php $segment_id="text".$this->work['id']."-segment".$segnum; ?>
                        <span class="segment" id="<?php echo $segment_id; ?>"><?php echo $this->nlBr($sentence['content']); ?></span>
                    <?php endforeach; ?>
                </div>
                <div class = "creator"> <?php echo (__('Text inserted by')).' ';  echo ($this->work['creator']); ?> </div>
            </div>  
        </div></div>
    
<!--<div id = "Rborder"></div>-->
<div class = "Bborder"><div class = "BLcorner"></div><div class = "BRcorner"></div></div>
</div>
</div>
</div>
<?php $this->page_title = __("Read text").': '.$this->escape($this->work['title']); ?>

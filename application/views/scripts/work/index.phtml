<?php $this->headScript()->appendFile($this->makeUrl('/js/close-ul.js')); ?>
<?php 
    function plural($sing, $plur, $number){
        if($number==0 or $number == 1)
            return __($sing);
        else
            return __($plur);
    }
?>
<table class="home">
<tr><td class="logo">
<div class="logo"><img src="<?php echo $this->makeUrl('/images/traduxio_home_logo.jpg'); ?>">
<div class="citation"><?php echo __('HOMEPAGE PHRASE') ?><span class="author">Eugenio Coseriu</span></div>
<div class="site-title"><?php echo __('Translating cultural texts') ?></div>
</div>
</td>
<td class="lang-list">

          
<ul>
<?php
foreach ($this->entries as $lang=>$authors) { ?>
    <li class='language'><?php echo $lang;?>
        <ul class='authors'>
<?php   foreach ($authors as $author=>$texts) { ?>
            <li class='author closed'><?php echo $author; ?>
            <ul class='texts'>
<?php       foreach ($texts as $text) { ?>
                <li class='text'><a href="<?php echo $this->url(
                    array('controller'=>'work','action'=>'read','id'=>$text['id'])) ?>">
                    <?php if($text['title']==''){echo '<i>'.__('No Title').'</i>';}else{echo $text['title'];} ?></a>
                    <?php if($text['count']>0):?><span class="trCount"> <?php echo __("(%1\$s Translations)",$text['count']);?></span><? endif; ?>
                </li>
<?php       } ?>
            </ul></li>
<?php   } ?>
        </ul></li>
<?php } ?>
</ul>
          
<dl>
    <!-- Loop through the entries that were provided to us by the controller -->
    <?php foreach ($this->entries as $entry): ?>
    <dt><a href="<?php echo $this->url(
            array('controller'=>'work','action'=>'read','id'=>$entry['id'])) ?>">
                         <?php echo $this->escape($entry->title) ?></a></dt>
  <?php endforeach ?>
</dl>
</td>

<td class="news hundred">
    <div class="news-paragraph"><div class="news-title"><?php echo __('Latest News');?></div>
    <?php $counter = 0; $MAX_NEWS = 15;
        foreach($this->news as $ageInSec=>$list): ?>
        <?php foreach($list as $key=> $item): 
            $counter++; 
            if($counter<=$MAX_NEWS):?>
            <ul><li>
            <?php echo $item['phrase']; ?>
           
            <?php $age=$item['age']; ?>
            <span class="age">
            <?php //$translate = new Zend_Translate('gettext',APPLICATION_PATH.'/../languages/en.mo','en'); 
            $translate = $this->translate;
          
            if($age < 60){$age = round($age);$units =plural("second","seconds",$age);}
            elseif($age < 3600){$age = round($age/60); $units = plural('minute','minutes',$age);}
            elseif($age < 86400){$age = round($age/3600); $units = plural('hour','hours',$age);}
            elseif($age < 2592000){$age = round($age/86400); $units = plural("day","days",$age);}
            
            /*if($age < 60){$age = round($age);$units =$translate->plural(__('second'),__('seconds'),$age);}
            elseif($age < 3600){$age = round($age/60); $units = $translate->plural(__('minute'),__('minutes'),$age);}
            elseif($age < 86400){$age = round($age/3600); $units = $translate->plural(__('hour'),__('hours'),$age);}
            elseif($age < 2592000){$age = round($age/86400); $units = $translate->plural(__('day'),__('days'),$age);}*/
          
            echo __("%1\$d %2\$s ago",$age,$units);
            ?>
            </span>    
            </li></ul>
        <?php endif; endforeach; ?>
    <?php endforeach; ?>
    </div>
</td>
</tr>
</table>

<?php $this->page_title=__('Homepage'); ?>
